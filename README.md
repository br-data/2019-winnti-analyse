# Our analysis

We, a team of reporters working with public broadcaster BR and NDR did an in-depth investigation on a group called *Winnti*. This group has infiltrated multiple companies around the world, for a couple of years by now- You can read about it [here](https://br24.de/winnti/english). After some initial digging around, we were made aware of so called **campaign identifiers**. In some instances, Winnti operators wrote the names of their targets directly into the malware, slightly obfucasted with a "rolling xor". In order to verify this, we first had to understand what a ["rolling xor"](https://my.safaribooksonline.com/book/networking/security/9780470613030/de-obfuscation/decoding_common_algorithms) is. One of our reporters wrote a script. It is not a very good script, but it does the trick.

After indeed finding some company names we reached out to [Moritz Contag](https://www.syssec.ruhr-uni-bochum.de/chair/staff/mcontag/). He wrote a much better script and thankfully allowed us to share it publicly. You can find the script in [this folder](https://github.com/br-data/2019-winnti-analysis/tree/master/script). It is called _parse.py_. You'll find a separate `Readme` for further instructions. [Silas Cutler](https://twitter.com/silascutler) helped us corroborate the findings. 

We also decided to publish some yara rules along with the article. They helped us to hunt for these samples. Maybe it is of help for some researchers out there. 

# Unsere Analyse

Wir, ein Team von Reportern und Reporterinnen des BR und NDR, haben uns in einer gemeinsamen Recherche ausführlich mit einer professionellen Hackergruppe beschäftigt. IT-Sicherheitsexperten nennen sie *Winnti*. Der Gruppe gelingt es seit Jahren, Unternehmensnetzwerke auszuspionieren – auch von DAX-Konzernen. Mehr zu der Recherche [hier](https://br24.de/winnti). Nach ein paar ersten Gesprächen wurde wir auf so genannte "Kampagnen-Hinweise" aufmerksam gemacht. In einigen Fällen sollen die Winnti-Hacker den Namen des Unternehmens direkt in die Schadsoftware geschrieben haben. Die Namen seien leicht verschleiert gewesen, mit einem "rolling xor". Wir mussten erst einmal verstehen, was ein ["rolling xor"](https://my.safaribooksonline.com/book/networking/security/9780470613030/de-obfuscation/decoding_common_algorithms) ist. Anschließend hat einer unserer Reporter ein Python-Skript geschrieben. Es ist kein sonderlich gutes Skript, aber erfüllt seine Aufgabe.

Nachdem wir tatsächlich auf Unternehmensnamen stießen, habemn wir uns an [Moritz Contag](https://www.syssec.ruhr-uni-bochum.de/chair/staff/mcontag/) gewendet. Er hat ein viel besseres Skript geschrieben und uns netterweise erlaubt, es zu veröffentlichen. Das Skript [findet sich hier](https://github.com/br-data/2019-winnti-analysis/tree/master/script). Es heißt _parse,py_. Eine `Readme`zur Bedienung ist dabei. [Silas Cutler ](https://twitter.com/silascutler) hat die Ergebnisse von Moritz bestätigt.

Wir haben uns auch dazu entschieden, ein paar Yara-Regeln mit zu veröffentlichen. Sie waren hilfreich, um Sample zu finden. Da das vielleicht hilfreich für ein paar IT-Sicherheitsforscher sein könnte, veröffentlichen wir auch diese Regeln.